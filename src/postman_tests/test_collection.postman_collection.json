{
	"info": {
		"_postman_id": "11e40d78-830f-4de2-bd84-645a815f9e16",
		"name": "TicTacToe_1",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "50481283",
		"_collection_link": "https://winifrst-5be2859a-2822992.postman.co/workspace/%D0%9F%D0%B5%D1%82%D1%80-%D0%A1%D1%83%D0%B2%D0%BE%D1%80%D0%B8%D0%BD's-Workspace~cb1f4236-e40b-4552-82ae-fa62713b6f58/collection/50481283-11e40d78-830f-4de2-bd84-645a815f9e16?action=share&source=collection_link&creator=50481283"
	},
	"item": [
		{
			"name": "New game",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Проверяем успешный ответ",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// Проверяем структуру ответа",
							"pm.test(\"Response has correct structure\", function () {",
							"    const response = pm.response.json();",
							"    ",
							"    pm.expect(response).to.have.property(\"gameId\");",
							"    pm.expect(response).to.have.property(\"board\");",
							"    pm.expect(response).to.have.property(\"status\");",
							"    ",
							"    pm.expect(response.status).to.equal(\"NEW_GAME\");",
							"    pm.expect(response.board).to.be.an(\"array\").with.lengthOf(3);",
							"    pm.expect(response.board[0]).to.be.an(\"array\").with.lengthOf(3);",
							"});",
							"",
							"// Сохраняем UUID игры для последующих тестов",
							"pm.test(\"Save game ID for future tests\", function () {",
							"    const response = pm.response.json();",
							"    pm.environment.set(\"game_id\", response.gameId);",
							"    ",
							"    console.log(\"Game ID saved: \" + response.gameId);",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"url": {
					"raw": "{{base_url}}/game/new",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"game",
						"new"
					]
				}
			},
			"response": []
		},
		{
			"name": "Post with 4x4 field",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Проверяем ошибку сервера",
							"pm.test(\"Status code is 400\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"pm.test(\"Returns error for invalid UUID\", function () {",
							"    const response = pm.response.json();",
							"    pm.expect(response.status).to.include(\"ERROR\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "  {\n    \"board\": [\n      [1, 0, 0, 0],\n      [0, 0, 0, 0],\n      [0, 0, 0, 0],\n      [0, 0, 0, 0]\n    ]\n  }",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{base_url}}/game/{{game_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"game",
						"{{game_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "First turn",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Проверяем успешный ответ",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// Проверяем, что компьютер сделал ответный ход",
							"pm.test(\"Computer made a move\", function () {",
							"    const response = pm.response.json();",
							"    ",
							"    pm.expect(response.status).to.be.oneOf([\"IN_PROGRESS\", \"COMPUTER_WON\", \"PLAYER_WON\", \"DRAW\"]);",
							"    ",
							"    // Проверяем, что на доске есть ход компьютера (2)",
							"    let computerMoves = 0;",
							"    for (let i = 0; i < 3; i++) {",
							"        for (let j = 0; j < 3; j++) {",
							"            if (response.board[i][j] === 2) {",
							"                computerMoves++;",
							"            }",
							"        }",
							"    }",
							"    ",
							"    // Компьютер должен был сделать ход если игра не закончилась",
							"    if (response.status === \"IN_PROGRESS\") {",
							"        pm.expect(computerMoves).to.equal(1);",
							"    }",
							"});",
							"",
							"// Проверяем структуру доски",
							"pm.test(\"Board has valid structure\", function () {",
							"    const response = pm.response.json();",
							"    ",
							"    pm.expect(response.board).to.be.an(\"array\").with.lengthOf(3);",
							"    response.board.forEach(row => {",
							"        pm.expect(row).to.be.an(\"array\").with.lengthOf(3);",
							"        row.forEach(cell => {",
							"            pm.expect(cell).to.be.oneOf([0, 1, 2]);",
							"        });",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "  {\n    \"board\": [\n      [1, 0, 0],\n      [0, 0, 0],\n      [0, 0, 0]\n    ]\n  }",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{base_url}}/game/{{game_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"game",
						"{{game_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Forbidden move (rewrite cell)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Проверяем ошибку валидации",
							"pm.test(\"Status code is 400\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"// Проверяем сообщение об ошибке",
							"pm.test(\"Returns INVALID_MOVE status\", function () {",
							"    const response = pm.response.json();",
							"    pm.expect(response.status).to.include(\"INVALID_MOVE\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "  {\n    \"board\": [\n      [2, 0, 0],  // Пытаемся изменить клетку, куда уже сходил компьютер (была 1)\n      [0, 1, 0],  // И добавляем свой ход\n      [0, 0, 0]\n    ]\n  }",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{base_url}}/game/{{game_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"game",
						"{{game_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Forbidden move (two turns)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Проверяем ошибку валидации",
							"pm.test(\"Status code is 400\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"// Проверяем сообщение об ошибке",
							"pm.test(\"Returns INVALID_MOVE for multiple moves\", function () {",
							"    const response = pm.response.json();",
							"    pm.expect(response.status).to.include(\"INVALID_MOVE\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "  {\n    \"board\": [\n      [1, 1, 0],  // Два хода сразу\n      [0, 0, 0],\n      [0, 0, 0]\n    ]\n  }",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{base_url}}/game/{{game_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"game",
						"{{game_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Invalid UUID",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Проверяем ошибку сервера",
							"pm.test(\"Status code is 400\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"pm.test(\"Returns error for invalid UUID\", function () {",
							"    const response = pm.response.json();",
							"    pm.expect(response.status).to.include(\"ERROR\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "  {\n    \"board\": [\n      [1, 0, 0],\n      [0, 0, 0],\n      [0, 0, 0]\n    ]\n  }",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{base_url}}/game/{{invalid_game_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"game",
						"{{invalid_game_id}}"
					]
				}
			},
			"response": []
		}
	]
}